Fix perf issues with long collections and variable explorer